name: Natural Daily Contributions

on:
  schedule:
    - cron: "0 1 * * *" # runs once at 09:00 AM PH TIME (UTC+8)
  workflow_dispatch:

jobs:
  contribute:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    env:
      GIT_AUTHOR_EMAIL: "144526580+JoeyCollado@users.noreply.github.com"
      GIT_COMMITTER_EMAIL: "144526580+JoeyCollado@users.noreply.github.com"
      GIT_AUTHOR_NAME: "JoeyCollado"
      GIT_COMMITTER_NAME: "JoeyCollado"
      TZ: "Asia/Manila"

    steps:
      - name: Clone and commit to multiple repositories
        env:
          TOKEN: ${{ secrets.PERSONAL_ACCESS_TOKEN }}
        run: |
          # list of repositories you want to commit to
          repos=(
            "JoeyCollado/Java-oop"
            "JoeyCollado/ExpressJsCourse"
            "JoeyCollado/absolute-movie"
            "JoeyCollado/portfolio2"
            "JoeyCollado/prisma-mongodb"
            "JoeyCollado/crud-project"
          )

          for repo in "${repos[@]}"; do
            echo "Processing $repo ..."
            git clone "https://x-access-token:${TOKEN}@github.com/$repo.git"
            cd "$(basename "$repo")"

            # possible target files
            files=(
              "README.md"
              ".keepalive"
              ".github/meta.log"
              "system.config"
              "env.example"
              "data.json"
            )

            # commit messages
            msgs=(
              "minor cleanup"
              "small tweak"
              "adjusted some formatting"
              "slight refactor"
              "updated minor metadata"
              "maintenance pass"
              "tiny improvements"
              "code polish"
              "dependency check"
              "minor optimization"
            )

            # random number of commits (10–20)
            count=$((RANDOM % 11 + 10))
            echo "Generating $count commits for $repo..."

            for i in $(seq 1 $count); do
              sleep $(( (RANDOM % 900) + 600 ))  # random delay between 10min–1hr 10min
              target=${files[$RANDOM % ${#files[@]}]}
              echo "update $(date +%s)" >> "$target"
              git add "$target"
              msg=${msgs[$RANDOM % ${#msgs[@]}]}
              git commit -m "$msg" || true
              git push origin main || true
            done

            cd ..
            rm -rf "$(basename "$repo")"
          done
