name: Daily Maintenance

on:
  schedule:
    - cron: "0 16 * * *" # 12 AM PH time
  workflow_dispatch:

jobs:
  commit:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout current repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 1

      - name: Configure git
        run: |
          git config --global user.name "JoeyCollado"
          git config --global user.email "akosijoeyaibertcollado@gmail.com"

      - name: Decide commit count (1â€“3)
        id: count
        run: echo "COUNT=$(( (RANDOM % 3) + 1 ))" >> $GITHUB_ENV

      - name: Apply updates
        run: |
          for i in $(seq 1 $COUNT); do
            sleep $((RANDOM % 1800)) # up to 30 min spacing

            echo "Update on $(date -u)" >> activity.log
            git add activity.log
            git commit -m "docs: daily log update" || exit 0
            git push
          done
