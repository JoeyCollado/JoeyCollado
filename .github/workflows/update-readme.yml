name: Natural Daily Contributions

on:
  schedule:
    - cron: "0 1 * * *" # runs once at 09:00 AM PH TIME (UTC+8 = 01:00 UTC)
  workflow_dispatch:

jobs:
  contribute:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    env:
      GIT_AUTHOR_EMAIL: "144526580+JoeyCollado@users.noreply.github.com"
      GIT_COMMITTER_EMAIL: "144526580+JoeyCollado@users.noreply.github.com"
      TZ: "Asia/Manila"

    steps:
      - uses: actions/checkout@v4

      - name: Generate random commit count (5–10)
        id: rnd
        run: echo "count=$((RANDOM % 6 + 5))" >> $GITHUB_OUTPUT

      - name: Run commits with natural delay
        run: |
          git config user.name "JoeyCollado"
          for i in $(seq 1 ${{ steps.rnd.outputs.count }}); do
            sleep $(( (RANDOM % 3600) + 600 ))  # random 10min–1hr 10min pauses per commit

            files=(
              "README.md"
              ".keepalive"
              ".github/meta.log"
              "system.config"
              "env.example"
              "data.json"
            )

            target=${files[$RANDOM % ${#files[@]}]}
            echo "update $(date +%s)" >> "$target"
            git add "$target"

            msgs=(
              "minor cleanup"
              "small tweak"
              "adjusted some formatting"
              "slight refactor"
              "updated minor metadata"
              "maintenance pass"
              "tiny improvements"
            )
            git commit -m "${msgs[$RANDOM % ${#msgs[@]}]}" || true
            git push origin main || true
          done
