name: Daily Activity Bot

on:
  schedule:
    # Runs daily at 12:00 AM Philippines time (UTC+8)
    - cron: "0 16 * * *"
  workflow_dispatch:

jobs:
  commit:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        repo:
          - gemini-cli
          - Prisma-Course
          - nextJsCourse2
          - Java-oop

    steps:
      - name: Random delay (0â€“8 hours)
        run: |
          DELAY=$((RANDOM % 28800))
          echo "Sleeping for $DELAY seconds"
          sleep $DELAY

      - name: Checkout repo
        uses: actions/checkout@v4
        with:
          repository: JoeyCollado/${{ matrix.repo }}
          token: ${{ secrets.PAT }}
          fetch-depth: 1

      - name: Configure git
        run: |
          git config --global user.name "Joey Collado"
          git config --global user.email "akosijoeyaibertcollado@gmail.com"

      - name: Make small change
        continue-on-error: true
        run: |
          CANDIDATES=()

          [ -f README.md ] && CANDIDATES+=("README.md")
          [ -f docs/notes.md ] && CANDIDATES+=("docs/notes.md")
          [ -f src/index.ts ] && CANDIDATES+=("src/index.ts")
          [ -f app/page.tsx ] && CANDIDATES+=("app/page.tsx")

          if [ ${#CANDIDATES[@]} -eq 0 ]; then
            echo "No editable files found, skipping."
            exit 0
          fi

          FILE=${CANDIDATES[$RANDOM % ${#CANDIDATES[@]}]}

          echo "" >> "$FILE"
          echo "<!-- update $(date) -->" >> "$FILE"

          git add "$FILE"
          git commit -m "chore: minor update" || exit 0
          git push
